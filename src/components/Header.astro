---
interface Props {
  lang?: string;
}
const { lang = "uz" } = Astro.props;
const isUz = lang === "uz";
---

<header id="header" class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-mid/50 transition-all duration-300">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-2 shrink-0">
        <img src="/images/logo.png" alt="Nishonchi" class="h-9 w-9 lg:h-10 lg:w-10" />
        <span class="text-lg lg:text-xl font-bold text-dark">Nishonchi</span>
      </a>

      <!-- Desktop Nav -->
      <nav class="hidden md:flex items-center gap-8">
        <a href="#services" class="text-sm font-medium text-text-light hover:text-primary transition-colors" data-i18n="nav.services">
          {isUz ? "Xizmatlar" : "Услуги"}
        </a>
        <a href="#results" class="text-sm font-medium text-text-light hover:text-primary transition-colors" data-i18n="nav.results">
          {isUz ? "Natijalar" : "Результаты"}
        </a>
        <a href="#contact" class="text-sm font-medium text-text-light hover:text-primary transition-colors" data-i18n="nav.contact">
          {isUz ? "Bog'lanish" : "Контакт"}
        </a>
      </nav>

      <!-- Right side -->
      <div class="flex items-center gap-3">
        <!-- Language toggle -->
        <button id="lang-toggle" class="text-xs font-semibold px-3 py-1.5 rounded-full border border-gray-mid hover:border-primary hover:text-primary transition-all" data-lang={lang}>
          {isUz ? "RU" : "UZ"}
        </button>

        <!-- CTA Desktop -->
        <a href="#contact" class="hidden md:inline-flex items-center px-5 py-2.5 bg-primary text-white text-sm font-semibold rounded-full hover:bg-primary-dark transition-all shadow-sm hover:shadow-md" data-i18n="nav.cta">
          {isUz ? "Bepul audit olish" : "Бесплатный аудит"}
        </a>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="md:hidden p-2 text-text-light hover:text-primary transition-colors" aria-label="Menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path id="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden pb-4">
      <nav class="flex flex-col gap-3">
        <a href="#services" class="text-sm font-medium text-text-light hover:text-primary py-2" data-i18n="nav.services">
          {isUz ? "Xizmatlar" : "Услуги"}
        </a>
        <a href="#results" class="text-sm font-medium text-text-light hover:text-primary py-2" data-i18n="nav.results">
          {isUz ? "Natijalar" : "Результаты"}
        </a>
        <a href="#contact" class="text-sm font-medium text-text-light hover:text-primary py-2" data-i18n="nav.contact">
          {isUz ? "Bog'lanish" : "Контакт"}
        </a>
        <a href="#contact" class="inline-flex items-center justify-center px-5 py-2.5 bg-primary text-white text-sm font-semibold rounded-full hover:bg-primary-dark transition-all mt-2" data-i18n="nav.cta">
          {isUz ? "Bepul audit olish" : "Бесплатный аудит"}
        </a>
      </nav>
    </div>
  </div>
</header>

<script>
  const menuBtn = document.getElementById("mobile-menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");

  menuBtn?.addEventListener("click", () => {
    const isOpen = !mobileMenu?.classList.contains("hidden");
    mobileMenu?.classList.toggle("hidden");
    if (isOpen) {
      menuIcon?.setAttribute("d", "M4 6h16M4 12h16M4 18h16");
    } else {
      menuIcon?.setAttribute("d", "M6 18L18 6M6 6l12 12");
    }
  });

  mobileMenu?.querySelectorAll("a").forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu.classList.add("hidden");
      menuIcon?.setAttribute("d", "M4 6h16M4 12h16M4 18h16");
    });
  });

  const langToggle = document.getElementById("lang-toggle");
  langToggle?.addEventListener("click", () => {
    const currentLang = langToggle.getAttribute("data-lang");
    const newLang = currentLang === "uz" ? "ru" : "uz";
    window.location.href = newLang === "uz" ? "/" : "/ru/";
  });
</script>
